# Feature Specification: Full application localization of web UI with Arabic and Simplified Chinese

**Feature Branch**: `002-translate-all-pages`  
**Created**: 2025-09-24  
**Status**: Draft  
**Input**: User description: "translate all pages in the web application inside ./web using the currently existing paraglide implementation. the messages are found inside ./web/messages/*\na sample code is found inside ./web/src/routes/demo/paraglide\n\nMake sure ARIA attributes that are read to the user are also translated\n\nData coming from the server NOT to be translated.\n\nKeep all original english labels as is and record them inside en.json without any changes! Make translations to ar.json (Arabic) and zh-cn.json (Simplified Chinese) (See <attachments> above for file contents. You may not need to search or read the file again.)"

## Execution Flow (main)
```
1. Parse user description from Input
   ‚Üí If empty: ERROR "No feature description provided"
2. Extract key concepts from description
   ‚Üí Identify: actors, actions, data, constraints
3. For each unclear aspect:
   ‚Üí Mark with [NEEDS CLARIFICATION: specific question]
4. Fill User Scenarios & Testing section
   ‚Üí If no clear user flow: ERROR "Cannot determine user scenarios"
5. Generate Functional Requirements
   ‚Üí Each requirement must be testable
   ‚Üí Mark ambiguous requirements
6. Identify Key Entities (if data involved)
7. Run Review Checklist
   ‚Üí If any [NEEDS CLARIFICATION]: WARN "Spec has uncertainties"
   ‚Üí If implementation details found: ERROR "Remove tech details"
8. Return: SUCCESS (spec ready for planning)
```

---

## ‚ö° Quick Guidelines
- ‚úÖ Focus on WHAT users need and WHY
- ‚ùå Avoid HOW to implement (no tech stack, APIs, code structure)
- üë• Written for business stakeholders, not developers

### Section Requirements
- **Mandatory sections**: Must be completed for every feature
- **Optional sections**: Include only when relevant to the feature
- When a section doesn't apply, remove it entirely (don't leave as "N/A")

### For AI Generation
When creating this spec from a user prompt:
1. **Mark all ambiguities**: Use [NEEDS CLARIFICATION: specific question] for any assumption you'd need to make
2. **Don't guess**: If the prompt doesn't specify something (e.g., "login system" without auth method), mark it
3. **Think like a tester**: Every vague requirement should fail the "testable and unambiguous" checklist item
4. **Common underspecified areas**:
   - User types and permissions
   - Data retention/deletion policies  
   - Performance targets and scale
   - Error handling behaviors
   - Integration requirements
   - Security/compliance needs

---

## Clarifications

### Session 2025-09-24
- Q: How can users switch languages within the app? ‚Üí A: Via the Account menu button; add a menu item to change language.
- Q: How should the selected language persist across sessions? ‚Üí A: paraglide setLocale Browser cookie.
- Q: Should Arabic use an RTL layout? ‚Üí A: Full RTL and mirrored UI for Arabic.
- Q: Are locale-specific formats in scope? ‚Üí A: No: strings only, no formatting.

---

## User Scenarios & Testing (mandatory)

### Primary User Story
As a visitor or signed-in user of the web application, I can view the entire user interface in my preferred language (English, Arabic, or Simplified Chinese), so that I can understand navigation, actions, and accessibility announcements. Data generated by users and saved in the database do not need to be altered or translated.

### Acceptance Scenarios
1. Given the app default language is English and a user opens any page, When the page renders, Then all UI labels, headings, buttons, links, helper texts, and accessibility announcements are displayed/read in English exactly as authored, and any server-provided data appears unchanged.
2. Given a user selects Arabic as the language (or the app loads in Arabic), When the user navigates across pages, Then all UI labels, headings, buttons, links, helper texts, and screen reader ARIA announcements are presented in Arabic, while server-provided data remains unmodified.
3. Given a user selects Simplified Chinese as the language (or the app loads in Simplified Chinese), When the user navigates across pages, Then all UI and ARIA strings are in Simplified Chinese, while server-provided data remains unmodified.
4. Given a translation key is missing in Arabic or Simplified Chinese, When the related UI renders, Then the application falls back to the English source text for that key without breaking layout or accessibility.
5. Given a UI string includes interpolated values that originate from the server (e.g., a username or product name), When displayed in a non-English language, Then only the surrounding label text is translated and the interpolated server-provided value remains exactly as received.
6. Given an interactive control with ARIA attributes (e.g., aria-label, aria-describedby, aria-live announcements), When the language is non-English, Then assistive technologies announce localized strings in the selected language, and no English text is announced unless it is server data or an intentional fallback.
7. Given the user opens the Account menu button, When they select the Language menu item and choose a different language, Then the UI immediately reflects the chosen language across the current page, ARIA announcements switch to the selected language, and server-provided data remains unchanged.
8. Given a user has changed the language using the Account menu, When they reload the page or open a new page in the app, Then the previously selected language remains in effect due to the paraglide setLocale browser cookie.
9. Given the language is set to Arabic, When any page renders, Then the layout uses full RTL with appropriate UI mirroring (including navigation order and alignment), ARIA strings are in Arabic, and server-provided data remains unchanged.
10. Given UI displays dates, times, numbers, or currency values, When the language changes, Then only surrounding UI labels are translated; the values themselves remain in their original format with no locale-specific reformatting.

### Edge Cases
- Missing or incomplete translations: Fallback to English must be consistent and non-disruptive to layout or ARIA.
- Mixed-language strings with dynamic data: Ensure placeholders/variables are not translated, while surrounding text is.
- Accessibility timing: Live region updates (e.g., status messages) must announce in the selected language without duplication.
- Right-to-left layout: Arabic uses full RTL with mirrored UI; verify no visual or interaction regressions and keyboard order remains logical.
- Locale formatting scope: No locale-specific formatting (dates, numbers, currency, pluralization) in this feature; ensure no unintended reformatting occurs.
- Language persistence behavior: Persist via using `$lib/paraglide/runtime` `setLocale` which defaults to a browser cookie across navigation and reloads.
- Pluralization beyond basic static strings: Out of scope; no locale plural rules applied this feature.

## Requirements (mandatory)

### Functional Requirements
- FR-001: The application MUST present all user-facing UI copy across all pages (navigation, headings, labels, buttons, helper text, tooltips, dialogs) in the user's selected language (English, Arabic, Simplified Chinese).
- FR-002: All user-facing strings MUST be sourced from a centralized message catalog, with English as the source-of-truth and preserved exactly as authored; English strings MUST be recorded in the English catalog without modification. no hard-coded literals remain.
- FR-003: The application MUST include translations for all keys into Arabic and Simplified Chinese.
- FR-004: Accessibility strings (including, but not limited to, aria-label, aria-labelledby, aria-describedby, aria-live region messages, role-associated names) MUST be localized in the selected language.
- FR-005: Data returned from the server (including dynamic values displayed in the UI) MUST NOT be translated or altered by the UI. Only surrounding UI labels and static copy are translated.
- FR-006: At runtime gracefully fallback to English or key name if translation not found.
- FR-008: Interpolated strings MUST preserve placeholders and order such that server-provided values appear verbatim while the non-variable text is localized appropriately.
- FR-010: QA criteria MUST verify that ARIA announcements in assistive technologies match the selected language for each page and key user flow.
- FR-011: Language preference MUST persist using `$lib/paraglide/runtime` `setLocale` which defaults to a browser cookie and remain effective across navigation and reloads.
- FR-012: Arabic MUST use a full RTL layout with mirrored UI behaviors where applicable; pages MUST render correctly without regression to navigation order, focus order, and interaction semantics.
- FR-013: Locale-sensitive formatting (dates, times, numbers, currency, pluralization) is OUT OF SCOPE for this feature; only UI strings are translated, and values are not reformatted.
- FR-014: The application MUST provide a language switcher entry within the Account menu button that allows users to change between configured languages (English, Arabic, Simplified Chinese). The control MUST be accessible (keyboard operable, visible focus) and expose appropriate localized accessible names/ARIA.
- FR-015: Switching the language via the Account menu MUST update visible UI strings and ARIA announcements immediately on the current page; server-provided data MUST remain unmodified.

### Key Entities (include if feature involves data)
- Message Catalog: A collection of translatable keys with values per supported language; English is the canonical source; Arabic and Simplified Chinese provide localized values; supports placeholders for interpolation.
- UI Text Surface: Any visible copy in the UI (labels, headings, descriptions, tooltips, dialog content) and accessibility strings associated with UI elements.
- Server Data: Any values returned from backend services that are displayed in the UI; excluded from translation and displayed verbatim.
Language Preference: The effective language used to render UI copy.
   - Source: Explicit user selection via the Account menu‚Äôs Language item (default English otherwise).
   - Persistence: `$lib/paraglide/runtime` `setLocale` stored in browser cookie across navigation and reloads.
   - Presentation: Arabic triggers RTL direction and mirrored UI treatment.

---

## Review & Acceptance Checklist

### Content Quality
- [ ] No implementation details (languages, frameworks, APIs)
- [ ] Focused on user value and business needs
- [ ] Written for non-technical stakeholders
- [ ] All mandatory sections completed
 - [ ] Constitution considerations addressed (privacy, ethics, accessibility, performance, i18n)

### Requirement Completeness
- [ ] No [NEEDS CLARIFICATION] markers remain
- [ ] Requirements are testable and unambiguous  
- [ ] Success criteria are measurable
- [ ] Scope is clearly bounded
- [ ] Dependencies and assumptions identified

---

## Execution Status

- [ ] User description parsed
- [ ] Key concepts extracted
- [ ] Ambiguities marked
- [ ] User scenarios defined
- [ ] Requirements generated
- [ ] Entities identified
- [ ] Review checklist passed
